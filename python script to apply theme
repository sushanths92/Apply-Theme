import os
import shutil

# Determine the path to the Themer folder
current_dir = os.path.dirname(os.path.abspath(__file__))
themer_folder = current_dir

# Define paths within the Themer folder
standard_resources_folder = os.path.join(themer_folder, 'standard_settings', 'KLA Power BI Template Visuals.Report', 'StaticResources', 'RegisteredResources')
pbi_resources_folder = os.path.join(themer_folder, 'pbi_file_in_pbip_format', 'KLA Power BI Template Visuals.Report', 'StaticResources', 'RegisteredResources')

def copy_registered_resources():
    if not os.path.exists(pbi_resources_folder):
        os.makedirs(pbi_resources_folder)
        
    # Copy all files from the standard resources folder to the pbi resources folder
    for item in os.listdir(standard_resources_folder):
        s = os.path.join(standard_resources_folder, item)
        d = os.path.join(pbi_resources_folder, item)
        if os.path.isfile(s):
            shutil.copy2(s, d)
        elif os.path.isdir(s):
            shutil.copytree(s, d, dirs_exist_ok=True)

if __name__ == "__main__":
    copy_registered_resources()
